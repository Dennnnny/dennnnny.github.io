{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-path-js","path":"/blog/from-hexo-to-gatsby-4/","result":{"data":{"markdownRemark":{"html":"<h1>Gatsby 搭配 google sheet</h1>\n<p>今天是要分享一個小功能<br>\n就是右上角的 Contact<br>\n點擊 contact 之後 會跳出一個彈窗<br>\n可以留下你想要說的話～<br>\n我很喜歡這個功能ＸＤ</p>\n<p>首先～<br>\n要先準備一個 google 表單<br>\n我們要來把表單當成是資料庫來使用<br>\n就來分享一下 如何一步一步的把這個資料庫做出來</p>\n<p>第一步： 建立新試算表</p>\n<p>接著要準備資料庫的程式碼<br>\n第二步： 開啟 app script<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bff277f74e404b59d89289a4ec2ec734/c1bea/google_sheet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.12883435582822%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABQklEQVQoz22Q7WqEMBBFff/nKvRPoVDKlmWtW63ummz8ikaNRk9JlpYWOnAzyTBMztzoIXtC5CWn+MTHR8rxeCRJErIs43A4hKy15qYUXddhrWVZlpB/y9e8osfLM/IieU8S4jgmTTOu12vQ+XymLEukuvFyeuWYnRBSYgaDEIKqqqjrGmNGfOz7TsS607QtUt4YpynQTNMUaMZxou8HmqahbhryoqAoCja34Zz70bbd39YTznbGGEPf6yClKpZ1DfjObVi7MM8zXaf5/MzDev+FH+j7orc45T0T5FKTXlSg8T91uifPC/phCI1ClpzTlMu1RFU1g6cfzF3G/NyjvKxR2tKOIJqRxc7sEIZUlQpEzq3oYaZpO9q2DdSeaP2t1YV65Fe7O7r5g30neOINvhtNGNiZhVJIpJR//PuWXWxY+QuHnhiis08oPwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/bff277f74e404b59d89289a4ec2ec734/a6d36/google_sheet.png\"\n        srcset=\"/static/bff277f74e404b59d89289a4ec2ec734/222b7/google_sheet.png 163w,\n/static/bff277f74e404b59d89289a4ec2ec734/ff46a/google_sheet.png 325w,\n/static/bff277f74e404b59d89289a4ec2ec734/a6d36/google_sheet.png 650w,\n/static/bff277f74e404b59d89289a4ec2ec734/e548f/google_sheet.png 975w,\n/static/bff277f74e404b59d89289a4ec2ec734/3c492/google_sheet.png 1300w,\n/static/bff277f74e404b59d89289a4ec2ec734/c1bea/google_sheet.png 1388w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n(在擴充功能中 點選)</p>\n<p>接下來就會先看到預設的一些程式</p>\n<pre class=\"grvsc-container abyss\" data-language=\"js\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15 mtki\">function</span><span class=\"mtk1\"> </span><span class=\"mtk6\">myFunction</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">//</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>這邊就是要來稍微操作一番的地方了<br>\n之後 我可能會 去理解一下 這整個 google sheet 的生態系\n跟他的細節<br>\n但現在 就先分享一下 我自己這邊做了什麼</p>\n<pre class=\"grvsc-container abyss\" data-language=\"js\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// do post 是之後產生一個連結網址  給你打api的時候</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 這個function 會在你對網址 method:POST 時執行的</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15 mtki\">function</span><span class=\"mtk1\"> </span><span class=\"mtk6\">doPost</span><span class=\"mtk1\">(</span><span class=\"mtk19 mtki\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// 拿名字叫 messages 的sheet(工作表)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> sheet </span><span class=\"mtk7\">=</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    SpreadsheetApp.</span><span class=\"mtk6\">getActiveSpreadsheet</span><span class=\"mtk1\">().</span><span class=\"mtk6\">getSheetByName</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;messages&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// 拿參數</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// 這邊我傳了 user 跟 message 當參數</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> params </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk15\">JSON</span><span class=\"mtk1\">.</span><span class=\"mtk15\">parse</span><span class=\"mtk1\">(e.postData.contents);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> { user, message } </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> params;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> createTime </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">NOW</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// 在表單裡插入一行資料</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// 內容是 [createTime, user, message] 分別儲存在前三欄的儲存格裡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  sheet.</span><span class=\"mtk6\">appendRow</span><span class=\"mtk1\">([createTime, user, message]);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> result </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    code: </span><span class=\"mtk4\">200</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    message: </span><span class=\"mtk11\">&quot;成功&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// 最後給api 一個response</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">return</span><span class=\"mtk1\"> ContentService.</span><span class=\"mtk6\">createTextOutput</span><span class=\"mtk1\">(</span><span class=\"mtk15\">JSON</span><span class=\"mtk1\">.</span><span class=\"mtk15\">stringify</span><span class=\"mtk1\">(result)).</span><span class=\"mtk6\">setMimeType</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ContentService.MimeType.JSON</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>寫完 function 後就要把他部署起來了<br>\n在右上方有顆部署按鈕<br>\n選擇 新增部署作業<br>\n我的設定是這個樣子的<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c8f5a4b38345fa0099dff321997e9efd/66632/deploy-app-script.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.6441717791411%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABTUlEQVQ4y5VSi26DMAzk/39w60PttFGVR6BJykLeVzlAR1eYVksnW4lzsc/O6prh7X2D7W4PKSUmizG+DLIsz09grEEIAd57KNWDcw5r7UvE9FZIiawoS9SMJUK6cM6jbVv0vU6E4Z+E9N4Yg+xbKXRdl36YjH5SSqUk+sD5v0FvKY/yM8xs0sFal2QQQt6l8ORXMOWQTNmSsDSc87mAEAIhDPoMCLPYP50/VDgnvHCOw/E4Eq6RLGORkCZNApORNlMFdBbGFn+D2k1DWSKU8oqiKFFVNVjTJNAmsKYFDdE5l3S27hHrFfY9yqqCNua+EjEGxJXqhm1ww1CWCLU2EPKaqqCWf6oY1uMJSQ67Tsg7i/3XBR9nicOJY/fZ4JBfsM09NnlEySNqGVGJARSXIuLax0fCyTsfoI2HsQHaemgbxjgmWBdh/ehnsQ8RNwD8/FlwyNYRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/c8f5a4b38345fa0099dff321997e9efd/a6d36/deploy-app-script.png\"\n        srcset=\"/static/c8f5a4b38345fa0099dff321997e9efd/222b7/deploy-app-script.png 163w,\n/static/c8f5a4b38345fa0099dff321997e9efd/ff46a/deploy-app-script.png 325w,\n/static/c8f5a4b38345fa0099dff321997e9efd/a6d36/deploy-app-script.png 650w,\n/static/c8f5a4b38345fa0099dff321997e9efd/e548f/deploy-app-script.png 975w,\n/static/c8f5a4b38345fa0099dff321997e9efd/3c492/deploy-app-script.png 1300w,\n/static/c8f5a4b38345fa0099dff321997e9efd/66632/deploy-app-script.png 1504w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\n點下部署按鈕後<br>\n他應該會跳出要同意授權的認證<br>\n確認之後<br>\n他就是部署成功～<br>\n接著可以拿到 api url 了<br>\n也可以在管理部署作業找到<br>\n網頁應用程式 網址<br>\n這個網址就是拿來打 api 用的<br>\n在網頁裡 打 api</p>\n<pre class=\"grvsc-container abyss\" data-language=\"js\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">fetch</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;apiUrl&quot;</span><span class=\"mtk1\">, { method: </span><span class=\"mtk11\">&quot;POST&quot;</span><span class=\"mtk1\">, body: { user: </span><span class=\"mtk11\">&quot;name&quot;</span><span class=\"mtk1\">, message: </span><span class=\"mtk11\">&quot;.....&quot;</span><span class=\"mtk1\"> } });</span></span></span></code></pre>\n<p>應該就能使用 google 表單當作資料庫了～～<br>\n這個用法我覺得很方便<br>\n如果是之後要整理成表單<br>\n或者資料應用的時候<br>\n就可以直接拿來用</p>\n<p>他除了 doPost 以外<br>\n也有 doGet 的 function 可以用<br>\n不過 之前用讀取的資料<br>\n好像都會要比較久一點點<br>\n所以目前也沒有很推薦使用ＸＤ<br>\n要讀寫的話 果然還是 firebase 更好用些<br>\n之後也會分享一點點 我使用 firebase 的作法之類的</p>\n<p>以上是今天的分享 👋</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .abyss { background-color: #000c18; }\n  .abyss .mtki { font-style: italic; }\n  .abyss .mtk15 { color: #9966B8; }\n  .abyss .mtk1 { color: #6688CC; }\n  .abyss .mtk6 { color: #DDBB88; }\n  .abyss .mtk3 { color: #384887; }\n  .abyss .mtk19 { color: #2277FF; }\n  .abyss .mtk7 { color: #225588; }\n  .abyss .mtk11 { color: #22AA44; }\n  .abyss .mtk4 { color: #F280D0; }\n  .abyss .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"date":"September 17, 2022","path":"/blog/from-hexo-to-gatsby-4","title":"Gatsby用起來_Google sheet","type":"blog","image_cover":"https://images.unsplash.com/photo-1663124178632-488f399d5763?fit=crop&w=1000&q=80"}}},"pageContext":{"id":"855df0b2-364e-594a-89e4-0c4b091115bc","frontmatter__path":"/blog/from-hexo-to-gatsby-4","__params":{"frontmatter__path":"blog"}}},"staticQueryHashes":["3764592887"]}